seldemo = []
custommaps = []
cmap = []

newgui main [
	guilist [ guilist [
	guitext (format "Welcome %1!" (getname))
	guibar
    guibutton "Online game"    "showgui multiplayer"
	if (= (isconnected) 0) [
    guibutton "Bot game"      "showgui botmatch"
    //guibutton "Campaign"       "showgui campaign"
    //guibutton "Load map"       "showgui maps"
	//guibutton "Custom map" 	"showgui cmaps"
	] []
    if (= (isconnected) 1) [
	if (= (getmode) 1) [
		if (= $mainmenu 0) [
			guibutton "Editing"        "showgui editing"
		] []
	] []
	] [
		if (= $mainmenu 0) [
			guibutton "Editing"        "showgui editing"
		] []
	]
    guibutton "Options"        "showgui options"
    guibutton "About"          "showgui about"
	guibar
	guitext "SauerEnhanced"
	guibutton " Settings"   "showgui se"
	guibutton " News"	"getsenews; showgui news"
	guibutton " Check for updates" chckforups
	guibutton " Stats"	"showgui stats"
	guibutton " HUD Guide" "showgui HUD-Guide"
	guibutton " About SE"	"showgui AboutSE"
	if (= (isconnected) 1) [
		if (= (getmode) 1) [
			if (= $mainmenu 0) [
				guibar
				guibutton " Edit map FX" "showgui SEPE"
				guibutton " Save map FX" "writesefile"
			] []
		] []
	] [
		if (= $mainmenu 0) [
			guibar
			guibutton " Edit map FX" "showgui SEPE"
			guibutton " Save map FX" "writesefile"
		] []
	]
	guibar
	if ((isconnected)) [
		guibar
		guibutton "Disconnect" "disconnect" "exit"
		guibutton "Vote game mode / map" "showgui gamemode"
		guibutton "Switch team" [if (strcmp (getteam) "good") [team evil] [team good]]
		if ((isspectator)) [
			guibutton "Join game" "spectator 0" "spectator"
		] [
			guibutton "Join spectators" "spectator 1" "spectator"
		]
	]
    guibutton "Quit"             "showgui quit"                 "exit"
	]
	]
]

newgui profiles [
	if (> (getprofilenum) 0) [
		loop i (getprofilenum) [
			guibutton (at (getprofiles) $i) [readprofile (at (getprofiles) $i); cleargui 1]
		]
	] [
		guitext "no profiles"
	]
	guibar
	guitext "add new profile:"
	guifield newprofilename 32
	guilist [
		guibutton create [createprofile $newprofilename]
		guibar
		guibutton quit [showgui quit]
	]
]

newgui AboutSE [
    guitext (concat "Version" (getseversion))
    guitext "Sounds, code and graphics by"
    guitext [Slawek "Q009" Blauciak]
    guitext [Adrenaline Cube 2 mod by Hypernova]
    guitext 
    guitext "Thanks to Quaker66 for help"
]

newgui NewVersion [
	guitext "There's new release of SauerEnhanced!"
	guitext "Download now?"
	guilist [
		guibutton "Yes" sedownload
		guibar
		guibutton "No" [cleargui 1]
	]
]

newgui NewPatch [
	guitext "There's new patch for SauerEnhanced!"
	guitext "Download now?"
	guilist [
		guibutton "Yes" [cleargui 1; sleep 500 [sepatch]]
		guibutton "No" [cleargui 1]
	]
]

newgui NoUpdates [
	guitext "There are no updates this time"
	guibutton "Ok" "cleargui 1"
]

newgui Error [
	guitext (geterrormsg)
	guitext
	guitext
	guibutton "Ok" "cleargui 1"
]

newgui DownloadCompleted [
	guitext "^f0Download completed!"
	guitext "^f2ZIP file is in Sauerbraten/seDownloads folder"
	guitext "^f2Unpack it and install!"
	guitext "You can see what's new by clicking a button '^f0What's new?'"
	guilist [
		guibutton Ok [cleargui 1]
		guibar
		guibutton "^f0What's new?" "getsenews; showgui news"
	]
]

newgui quit [
    guitext "Are you sure?"
    guilist [
        guibutton "^f0No " [cleargui 1]
        guibar
        guibutton "^f3Yes" quit exit
    ]
]

newgui cmaps [
	guitext "Add/remove custom map:"
	guifield cmap 32
	guistayopen [
		guitext
		guibutton (concat "Add " $cmap) "addobject custommaps $cmap"
		guibutton (concat "Del " $cmap) "delobject custommaps $cmap"
	]
	guibar
	looplist m $custommaps [
		guibutton $m [map @m]
	]
]

newgui se [
    guititle "SauerbratenEnhanced"
    guilist [ guilist [
    //guitext "Features"
    //guitext "Not all features can be disabled yet..."
    //guicheckbox "Improved gun effects" seimprovedguneffects
    //guicheckbox "Improved explosion effects" seimprovedexplosions
    //guicheckbox "Improved projectile effects" seimprovedprojectiles
    //guicheckbox "Bullet impact effects" sebulletimpactsmoke
    //guicheckbox "Bullet impact sound" sebulletimpactsound
    guicheckbox "Show teammate names near crosshair" seteamnames
    //guicheckbox "Load additional map entities" loadse
    //guicheckbox "New weather effects" seweather
    guicheckbox "Auto-says" seautosay
    //guicheckbox "Glow particles" seglow
    //guicheckbox "New HUD" senewhud
    guicheckbox "Show FPS" showfps 1 0
    //guicheckbox "Old-style rifle trail" serifletrail
    guicheckbox "Check for updates on start" seupdatecheck
    guicheckbox "Random bot names" rndbotnames
    guibar
    newmsg = $seendmsg
    guitext "Message on end of match:"
    guifield newmsg 64 [seendmsg $newmsg]
    ] ]
]

newgui servers [
    guistayopen [
        guilist [
            guibutton "update server list from master server" "updatefrommaster"
            guibar
            guicheckbox "search LAN" searchlan
            guibar
            guibutton "Sort servers" sortservers
        ]
    ]
    guibar
    guiservers
]

newgui HUD-Guide [
	guilist [
	guiimage "data/HUD_guide/hudguide1.jpg" "" 5 1
	guiimage "data/HUD_guide/hudguide2.jpg" "" 5 1
	]
]

newgui stats [
	guilist [ guilist [
	guitext "Total shots"
	//guitext "Total damage dealt"
	guitext "Total jumps"
	//guitext "Average accuracy"
	guitext "Total deaths"
	guitext "Total bots killed"
	guitext "Total unnameds killed"
	guitext "Total players killed"
	guitext "Total flags scored (ctf)"
	guitext "Total flags scored (protect) "
	guitext "Times said 'lol'"
	guitext "QuadDamages taken"
	guitext "HealthBoosts taken"
	guitext "Ammo packs taken"
	guitext "Health kits taken"
	guitext "Kills with chainsaw"
	guitext "Total suicide commits"
	guitext "Total play time "
	]
	guilist [
	guitext (stats 0)
	//guitext (stats 1)
	guitext (stats 2)
	//guitext (stats 3)
	guitext (stats 4)
	guitext (stats 6)
	guitext (stats 7)
	guitext (stats 8)
	guitext (stats 9)
	guitext (stats 10)
	guitext (stats 12)
	guitext (stats 13)
	guitext (stats 14)
	guitext (stats 15)
	guitext (stats 16)
	guitext (stats 17)
	guitext (stats 18)
	guitext (format "%1w %2d %3h %4m %5s" (stats 23) (stats 22) (stats 21) (stats 20) (stats 19))
	]
	]
]

newgui demos [
	guitext "Demo list:"
	guistayopen [
		loopfiles f (format "SauerEnhanced/profiles/%1/demos" (getprofile)) "dmo" [
			guibutton $f [seldemo = @f]
		]
	]
	guibar
	guitext (concat "Selected demo:" $seldemo)
]

//particle editor

wrwx = [20]	//rain wind x
wrwy = [20]	//rain wind y
wrc  = [0xFFF]	//rain colour
wrd  = [25]	//rain density

wfr = [128]	//Fog radius
wfc = [0x222]	//Fog colour
wfs = [100]	//Fog size

wswx = [20]	//snow radius
wswy = [-20]	//snow wind
wsc  = [0xFFF]	//snow colour
wsd  = [25]	//snow density

lgc = [0x222]	//glow colour
lgs = [16]		//glow size
lgf = [0]		//glow flicker

newgui SEPE [
	guititle "SauerEnhanced particle editor"
	guitext "Here you can edit map effects"
	guitext "Rain"
	guitext "Rain fog"
	guitext "Snow"
	guitext "And glow"
	guibar
	guitext "Hint:"
	guitext "When you'll done just click 'Save map FX' in your menu!"
	guibar
	guitext "Have fun enhancing your favourite maps! ;)"

	guitab Rain
	guilist [ guilist [
	guitext " Wind X"
	guislider wrwx -50 50
	guitext " Wind Y"
	guislider wrwy -50 50
	guitext " Colour (HEX: 0xRGB)"
	guifield wrc 6
	guitext " Density"
	guifield wrd 6
	guibar
	guitext (format "particles 78 %1 %2 %3 %4" $wrwx $wrwy $wrc $wrd)
	guibutton "Create!" "newent particles 78 $wrwx $wrwy $wrc $wrd"
	]]

	guitab RainFog
	guilist [ guilist [
	guitext " Radius"
	guislider wfr 1 2048
	guifield wfr 5
	guitext " Colour (HEX: 0xRGB)"
	guifield wfc 6
	guitext " Size"
	guislider wfs 32 256
	guifield wfs 4
	guibar
	guitext (format "particles 80 %1 %2 %3" $wfr $wfc $wfs)
	guibutton "Create!" "newent particles 80 $wfr $wfc $wfs"
	]]

	guitab Snow
	guilist [ guilist [
	guitext " Wind X"
	guislider wswx -50 50
	guitext " Wind Y"
	guislider wswy -50 50
	guitext " Colour (HEX: 0xRGB)"
	guifield wsc 6
	guitext " Density"
	guifield wsd 6
	guibar
	guitext (format "particles 77 %1 %2 %3 %4" $wswx $wswy $wsc $wsd)
	guibutton "Create!" "newent particles 77 $wswx $wswy $wsc $wsd"
	]]

	guitab Glow
	guilist [ guilist [
	guitext " Colour (HEX: 0xRGB)"
	guifield lgc 6
	guitext " Size"
	guislider lgs 32 256
	guifield lgs 4
	guicheckbox "Flicker" lgf
	guibar
	guitext (format "particles 79 %1 %2 %3" $lgc $lgs $lgf)
	guibutton "Create!" "newent particles 79 $lgc $lgs $lgf"
	]]
]
